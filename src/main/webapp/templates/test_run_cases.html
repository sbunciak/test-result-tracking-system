<html>
<head>
<script type="text/javascript">
$(document).ready(function() {
	/*
	$('form').submit(function() {
        addTestRun($('form').serializeObject());
        return false;
    });
	*/
	
	$('#product_id').change(function() {
		var prd_id = $('#product_id').val();

		$.ajax({
			url : "rest/products/" + prd_id + "/versions",
			cache : false,
			success : function(data) {
				$('#product_version_id').empty().append(buildProductVersionOptions(data));
			},
			error : function(error) {
				addMessage("error", "error fetching product versions -" + error.status);
			}
		});
	});

	$('#product_version_id').change(function() {
		var prd_id = $('#product_id').val();
		var prv_id = $('#product_version_id').val();
		
		$.ajax({
			url : "rest/products/" + prd_id + "/versions/"+prv_id+"/testplans",
			cache : false,
			success : function(data) {
				$('#test_plan_id').empty().append(buildTestPlanOptions(data));
			},
			error : function(error) {
				addMessage("error", "error fetching product values -" + error.status);
			}
		});
		$.ajax({
			url : "rest/products/" + prd_id + "/versions/"+prv_id+"/builds",
			cache : false,
			success : function(data) {
				$('#product_build_id').empty().append(buildProductBuildOptions(data));
			},
			error : function(error) {
				addMessage("error", "error fetching product values -" + error.status);
			}
		});
	});

	$('#test_plan_id').change(function() {
		var prd_id = $('#product_id').val();
		var ver_id = $('#product_version_id').val();
		var bld_id = $('#product_build_id').val();
		var tpl_id = $('#test_plan_id').val();

		$.ajax({
			url : "rest/products/" + prd_id + "/versions/" + ver_id
			+ "/builds/"+bld_id+"/testplans/" + tpl_id + "/runs",
			cache : false,
			success : function(data) {
				$('#test_run_id').empty().append(buildTestRunOptions(data));
			},
			error : function(error) {
				addMessage("error", "error fetching test runs -" + error.status);
			}
		});
	});

	$('#product_build_id').change(function() {
		var prd_id = $('#product_id').val();
		var ver_id = $('#product_version_id').val();
		var bld_id = $('#product_build_id').val();
		var tpl_id = $('#test_plan_id').val();

		$.ajax({
			url : "rest/products/" + prd_id + "/versions/" + ver_id
			+ "/builds/"+bld_id+"/testplans/" + tpl_id + "/runs",
			cache : false,
			success : function(data) {
				$('#test_run_id').empty().append(buildTestRunOptions(data));
			},
			error : function(error) {
				addMessage("error", "error fetching test runs -" + error.status);
			}
		});
	});

	$('#test_run_id').change(function() {
		listTestRunCases();
	});
	
	$.ajax({
		url : "rest/products",
		cache : false,
		success : function(data) {
			$('#product_id').empty().append(buildProductOptions(data));
		},
		error : function(error) {
			addMessage("error", "error fetching products -" + error.status);
		}
	});
});

</script>
</head>

<h3>Test run cases</h3>
<fieldset>
	<label>Product</label> <select name="product_id" id="product_id"></select>

	<label>Product version</label> <select name="product_version_id"
		id="product_version_id"></select> <label>Product build</label> <select
		name="product_build_id" id="product_build_id"></select> <label>Test
		plan</label> <select name="test_plan_id" id="test_plan_id"></select> <label>Test
		run</label> <select name="test_run_id" id="test_run_id"></select>
</fieldset>


<div class="tab_container">
	<div class="tab_content">
		<table class="tablesorter">
			<thead>
				<tr>
					<th>Title</th>
					<th>Criterias</th>
					<th>Tester</th>
					<th>CI Link</th>
					<th>Bug Tracking Link</th>
					<th>Result</th>
					<th>ID</th>
					<th>Actions</th>
				</tr>
			</thead>
			<tbody id="test_run_cases_content">

			</tbody>
		</table>
	</div>
	<!-- end of tab -->


</div>
<!-- end of .tab_container -->


<form action="">
<div class="module_content">
	<h3>Add new Test run</h3>
	
	<fieldset>
		<label>Name</label> <input type="text" name="name" id="name"/>
	</fieldset>
	<div class="clear"></div>
</div>
<footer>
	<div class="submit_link">
		<input type="submit" value="Save" class="alt_btn" /> 
		<input type="reset" value="Reset" />
	</div>
</footer>
</form>

</html>